{"docstore/data": {"78f87955-bf5a-4bba-a8cc-ab4cd0294c19": {"__data__": {"id_": "78f87955-bf5a-4bba-a8cc-ab4cd0294c19", "embedding": null, "metadata": {"filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8c396897-91cd-412b-a421-dc3886e6a339", "node_type": "4", "metadata": {"filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "hash": "105de37611c2a93fe217d88153f90f776c8a791f68deff29a4a5d90a8dafde32", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "cbec8ab3-84f8-4543-ad70-432ee6465d4b", "node_type": "1", "metadata": {"Header_2": " File-Level Retrieval"}, "hash": "fdc3e992b443c757c75cbfad40f3fef0824ee39797e9d354c79476876ae80092", "class_name": "RelatedNodeInfo"}}, "text": "Building a robust question-answering assistant requires dynamically retrieving\nthe most relevant information for each query. Sometimes a short snippet\nprovides a complete answer, while other questions need the full context of an\nentire document (e.g. \u201cGive me a summary of this book\u201d).\n\nFor questions that fall into the latter category, top-k vector search falls\nshort; rather than just retrieving the top-k chunks that match, you need to\nintentionally retrieve the entire document text and feed that into the context\nwindow of the LLM.\n\nTo address this, we\u2019re excited to release **file-level retrieval** for\nLlamaCloud, which is a separate retrieval API from our existing **chunk-level\nretrieval** capabilities. This retrieval interface then paves the way for us\nto build an agent that can dynamically route the question to the right\nretrieval interface depending on the properties of the question, which allows\nit to more robustly handle different user questions.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 965, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "cbec8ab3-84f8-4543-ad70-432ee6465d4b": {"__data__": {"id_": "cbec8ab3-84f8-4543-ad70-432ee6465d4b", "embedding": null, "metadata": {"Header_2": " File-Level Retrieval", "filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8c396897-91cd-412b-a421-dc3886e6a339", "node_type": "4", "metadata": {"filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "hash": "105de37611c2a93fe217d88153f90f776c8a791f68deff29a4a5d90a8dafde32", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "78f87955-bf5a-4bba-a8cc-ab4cd0294c19", "node_type": "1", "metadata": {"filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "hash": "cb4f27d01f2cc83af8276c8bd2d593299ce05126e754cc9cf0d1f44ec3bbd0c2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "9e458284-bbd4-4ed3-8e0c-de5d27ba1a83", "node_type": "1", "metadata": {"Header_2": " Building an Agent for Dynamic Retrieval"}, "hash": "531ebd0a725ca53bbe399625f27b0e6b7155532710240d2b176929ef5323faf7", "class_name": "RelatedNodeInfo"}}, "text": "File-Level Retrieval\n\nThis method retrieves the full content of a document, such as an entire SEC\n10K filing or an entire slide deck. There are two main ways to perform file-\nlevel retrieval:\n\n  * **By Metadata** : Selects files based on their metadata. \n  * **By Content** : Uses the document's content to determine the most relevant files. \n\nThe interface allows you to seamlessly toggle between retrieval modes, and\nadjust parameters like top-k results, and even filter by metadata when using\nfile-level retrieval.", "mimetype": "text/plain", "start_char_idx": 971, "end_char_idx": 1488, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "9e458284-bbd4-4ed3-8e0c-de5d27ba1a83": {"__data__": {"id_": "9e458284-bbd4-4ed3-8e0c-de5d27ba1a83", "embedding": null, "metadata": {"Header_2": " Building an Agent for Dynamic Retrieval", "filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8c396897-91cd-412b-a421-dc3886e6a339", "node_type": "4", "metadata": {"filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "hash": "105de37611c2a93fe217d88153f90f776c8a791f68deff29a4a5d90a8dafde32", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "cbec8ab3-84f8-4543-ad70-432ee6465d4b", "node_type": "1", "metadata": {"Header_2": " File-Level Retrieval", "filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "hash": "255e077cea40c52a2e92b58023d2fa115455427dd234e4de85e8b40389886a0d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "574fe1a9-a6e6-4647-997c-9acdf3043cd9", "node_type": "1", "metadata": {"Header_2": " Build more Robust QA Interfaces Starting Today"}, "hash": "8b207306085448357642e869f5ce5d6433cc91c7ebfb7214a051a6d4fe42ff25", "class_name": "RelatedNodeInfo"}}, "text": "Building an Agent for Dynamic Retrieval\n\nTo demonstrate the power of dynamic retrieval, we've created [ a Jupyter\nnotebook ](https://github.com/run-llama/llamacloud-\ndemo/blob/main/examples/10k_apple_tesla/demo_file_retrieval.ipynb) that guides\nyou through building an agent capable of choosing between chunk-level and\nfile-level retrieval based on the question at hand. Let's walk through the key\nsteps:\n\n  1. **Defining Retrievers** : We set up both chunk-level and file-level retrievers using LlamaCloud's ` as_retriever ` method. These can be converted into query engines that can synthesize an answer over retrieved context given a question. \n\n    \n    \n    # File-level retriever\n    doc_retriever = index.as_retriever(\n        retrieval_mode=\"files_via_content\",\n        files_top_k=1\n    )\n    \n    # Chunk-level retriever\n    chunk_retriever = index.as_retriever(\n        retrieval_mode=\"chunks\",\n        rerank_top_n=5\n    )\n\n  1. **Building the Agent** : The heart of the notebook is the agent that decides which query tool to use. It analyzes the input question and chooses the appropriate retrieval method based on the tool description. In this section, we keep it simple - tell the agent to choose file-level retrieval if the question is more for \u201chigh-level summarization\u201d, otherwise do chunk-level retrieval. \n  2. **Testing the Agent** : Even with these basic tool prompts, our agent can already intelligently decide to perform file-level retrieval for more \u201csummarization-esque\u201d questions. \n\n    \n    \n    # uses chunk-level retrieval twice\n    response = agent.chat(\"Tell me the revenue for Apple and Tesla in 2021?\")\n    print(response)\n    \n    # uses file-level retrieval twice\n    response = agent.chat(\"How was Tesla doing generally in 2021 and 2022?\")\n    print(response)\n\n  1. **[Advanced] File-level Retrieval** : The notebook also demonstrates how to set up more sophisticated file-level retrieval by inferring metadata filters and injecting few-shot examples of existing files, letting the agent better make a decision of file-level vs. chunk-level based on the actual files that have been uploaded instead of just a fixed prompt.", "mimetype": "text/plain", "start_char_idx": 1494, "end_char_idx": 3653, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "574fe1a9-a6e6-4647-997c-9acdf3043cd9": {"__data__": {"id_": "574fe1a9-a6e6-4647-997c-9acdf3043cd9", "embedding": null, "metadata": {"Header_2": " Build more Robust QA Interfaces Starting Today", "filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8c396897-91cd-412b-a421-dc3886e6a339", "node_type": "4", "metadata": {"filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "hash": "105de37611c2a93fe217d88153f90f776c8a791f68deff29a4a5d90a8dafde32", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "9e458284-bbd4-4ed3-8e0c-de5d27ba1a83", "node_type": "1", "metadata": {"Header_2": " Building an Agent for Dynamic Retrieval", "filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "hash": "598087d76cb7d107f1bd99724431c3e7a021a9c62b19434bddb2d0b680c450c9", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "74b209ee-5fe5-49fe-bc18-3b0a0693c528", "node_type": "1", "metadata": {"Header_2": " Want to see what LlamaCloud can do for you?"}, "hash": "6e799ba0cee3c6ea38d2911e0f274e4b9a04a0dea97b3b086d68a20aaefd06c6", "class_name": "RelatedNodeInfo"}}, "text": "Build more Robust QA Interfaces Starting Today\n\nLlamaCloud's dynamic retrieval capabilities represent a significant step\nforward in building more intelligent and context-aware LLM applications. By\noffering the flexibility to choose between chunk-level and file-level\nretrieval, developers can create more nuanced and accurate systems that adapt\nto the specific needs of each query.\n\nWe encourage you to explore these new features in the LlamaCloud UI and try\nout the notebook for yourself. As always, we're excited to see what you'll\nbuild with these enhanced retrieval capabilities!", "mimetype": "text/plain", "start_char_idx": 3660, "end_char_idx": 4243, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "74b209ee-5fe5-49fe-bc18-3b0a0693c528": {"__data__": {"id_": "74b209ee-5fe5-49fe-bc18-3b0a0693c528", "embedding": null, "metadata": {"Header_2": " Want to see what LlamaCloud can do for you?", "filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "8c396897-91cd-412b-a421-dc3886e6a339", "node_type": "4", "metadata": {"filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "hash": "105de37611c2a93fe217d88153f90f776c8a791f68deff29a4a5d90a8dafde32", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "574fe1a9-a6e6-4647-997c-9acdf3043cd9", "node_type": "1", "metadata": {"Header_2": " Build more Robust QA Interfaces Starting Today", "filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}, "hash": "9884bc52c26ab1f86df55cf864d249bfc7cff7ed7797ca8fc84cbd714b5a1547", "class_name": "RelatedNodeInfo"}}, "text": "Want to see what LlamaCloud can do for you?\n\nCome sign up on our [ waitlist ](https://bit.ly/llamacloud) for access. If\nyou\u2019re interested in chatting about enterprise plans, [ get in touch.\n](https://www.llamaindex.ai/contact)\n\nIf you\u2019ve gotten access to LlamaCloud, check out our [ rich repository of\ndemonstrations and examples ](https://github.com/run-llama/llamacloud-demo) on\nhow to build different LLM application use cases.", "mimetype": "text/plain", "start_char_idx": 4249, "end_char_idx": 4679, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}}, "docstore/metadata": {"78f87955-bf5a-4bba-a8cc-ab4cd0294c19": {"doc_hash": "cb4f27d01f2cc83af8276c8bd2d593299ce05126e754cc9cf0d1f44ec3bbd0c2", "ref_doc_id": "8c396897-91cd-412b-a421-dc3886e6a339"}, "cbec8ab3-84f8-4543-ad70-432ee6465d4b": {"doc_hash": "255e077cea40c52a2e92b58023d2fa115455427dd234e4de85e8b40389886a0d", "ref_doc_id": "8c396897-91cd-412b-a421-dc3886e6a339"}, "9e458284-bbd4-4ed3-8e0c-de5d27ba1a83": {"doc_hash": "598087d76cb7d107f1bd99724431c3e7a021a9c62b19434bddb2d0b680c450c9", "ref_doc_id": "8c396897-91cd-412b-a421-dc3886e6a339"}, "574fe1a9-a6e6-4647-997c-9acdf3043cd9": {"doc_hash": "9884bc52c26ab1f86df55cf864d249bfc7cff7ed7797ca8fc84cbd714b5a1547", "ref_doc_id": "8c396897-91cd-412b-a421-dc3886e6a339"}, "74b209ee-5fe5-49fe-bc18-3b0a0693c528": {"doc_hash": "f2bd4c924261c28bde29623dcd8294b4ff207a4e73b078e52228d19ef560524e", "ref_doc_id": "8c396897-91cd-412b-a421-dc3886e6a339"}}, "docstore/ref_doc_info": {"8c396897-91cd-412b-a421-dc3886e6a339": {"node_ids": ["78f87955-bf5a-4bba-a8cc-ab4cd0294c19", "cbec8ab3-84f8-4543-ad70-432ee6465d4b", "9e458284-bbd4-4ed3-8e0c-de5d27ba1a83", "574fe1a9-a6e6-4647-997c-9acdf3043cd9", "74b209ee-5fe5-49fe-bc18-3b0a0693c528"], "metadata": {"filename": "dynamic-retrieval-with-llamacloud.md", "extension": ".md", "title": "Dynamic Retrieval with LlamaCloud", "date": "Jul 30, 2024", "url": "https://www.llamaindex.ai/blog/dynamic-retrieval-with-llamacloud"}}}}