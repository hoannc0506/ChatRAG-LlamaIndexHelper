{"docstore/data": {"23c44ef1-bc1a-4c5a-bed6-8e1432fe4b84": {"__data__": {"id_": "23c44ef1-bc1a-4c5a-bed6-8e1432fe4b84", "embedding": null, "metadata": {"Header_1": " Introduction", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17", "node_type": "4", "metadata": {"filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "ff11ebb3d7de32b43dc883b6272a9ff5d0f95926e8f0e37dbe9041b25ea90f9d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "5ec14ed4-c2a2-4d31-89e8-2213dc12279c", "node_type": "1", "metadata": {"Header_1": " Sample Dataset of Product Reviews"}, "hash": "25eb609cb30aef01c02a0164e5397b32df04c7b1d2e5cdc7f716638edcaa54cb", "class_name": "RelatedNodeInfo"}}, "text": "Introduction\n\nE-commerce platforms, such as Amazon and Walmart, are teeming with products\nthat attract a multitude of reviews every single day. These reviews are\ncrucial touchpoints that reflect consumer sentiments about products. But how\ncan businesses sift through vast databases to derive meaningful insights from\nthese reviews?\n\nThe answer lies in combining SQL with RAG (Retrieval Augmented Generation)\nthrough LlamaIndex.\n\nLet\u2019s deep dive into this!", "mimetype": "text/plain", "start_char_idx": 3, "end_char_idx": 458, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "5ec14ed4-c2a2-4d31-89e8-2213dc12279c": {"__data__": {"id_": "5ec14ed4-c2a2-4d31-89e8-2213dc12279c", "embedding": null, "metadata": {"Header_1": " Sample Dataset of Product Reviews", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17", "node_type": "4", "metadata": {"filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "ff11ebb3d7de32b43dc883b6272a9ff5d0f95926e8f0e37dbe9041b25ea90f9d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "23c44ef1-bc1a-4c5a-bed6-8e1432fe4b84", "node_type": "1", "metadata": {"Header_1": " Introduction", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "a6eb8fa2963388d9e103d73dac694893072423e2615550dc733bc054bd5ec72e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b6ac78f9-6a1c-40c0-8f3d-8504dc757ac6", "node_type": "1", "metadata": {"Header_1": " Setting up an In-Memory Database"}, "hash": "d4832ec92214f87d040a0b02c3d98d7aaa1864e71539d7ad97ce455b8637f7eb", "class_name": "RelatedNodeInfo"}}, "text": "Sample Dataset of Product Reviews\n\nFor the purpose of this demonstration, we\u2019ve generated a sample dataset using\nGPT-4 that comprises reviews for three products: iPhone13, SamsungTV, and an\nErgonomic Chair. Here\u2019s a sneak peek:\n\n  * iPhone13: \u201cAmazing battery life and camera quality. Best iPhone yet.\u201d \n  * SamsungTV: \u201cImpressive picture clarity and vibrant colors. A top-notch TV.\u201d \n  * Ergonomic Chair: \u201cFeels really comfortable even after long hours.\u201d \n\nHere is a sample dataset.\n\n    \n    \n    rows = [\n        # iPhone13 Reviews\n        {\"category\": \"Phone\", \"product_name\": \"Iphone13\", \"review\": \"The iPhone13 is a stellar leap forward. From its sleek design to the crystal-clear display, it screams luxury and functionality. Coupled with the enhanced battery life and an A15 chip, it's clear Apple has once again raised the bar in the smartphone industry.\"},\n        {\"category\": \"Phone\", \"product_name\": \"Iphone13\", \"review\": \"This model brings the brilliance of the ProMotion display, changing the dynamics of screen interaction. The rich colors, smooth transitions, and lag-free experience make daily tasks and gaming absolutely delightful.\"},\n        {\"category\": \"Phone\", \"product_name\": \"Iphone13\", \"review\": \"The 5G capabilities are the true game-changer. Streaming, downloading, or even regular browsing feels like a breeze. It's remarkable how seamless the integration feels, and it's obvious that Apple has invested a lot in refining the experience.\"},\n    \n        # SamsungTV Reviews\n        {\"category\": \"TV\", \"product_name\": \"SamsungTV\", \"review\": \"Samsung's display technology has always been at the forefront, but with this TV, they've outdone themselves. Every visual is crisp, the colors are vibrant, and the depth of the blacks is simply mesmerizing. The smart features only add to the luxurious viewing experience.\"},\n        {\"category\": \"TV\", \"product_name\": \"SamsungTV\", \"review\": \"This isn't just a TV; it's a centerpiece for the living room. The ultra-slim bezels and the sleek design make it a visual treat even when it's turned off. And when it's on, the 4K resolution delivers a cinematic experience right at home.\"},\n        {\"category\": \"TV\", \"product_name\": \"SamsungTV\", \"review\": \"The sound quality, often an oversight in many TVs, matches the visual prowess. It creates an enveloping atmosphere that's hard to get without an external sound system. Combined with its user-friendly interface, it's the TV I've always dreamt of.\"},\n    \n        # Ergonomic Chair Reviews\n        {\"category\": \"Furniture\", \"product_name\": \"Ergonomic Chair\", \"review\": \"Shifting to this ergonomic chair was a decision I wish I'd made earlier. Not only does it look sophisticated in its design, but the level of comfort is unparalleled. Long hours at the desk now feel less daunting, and my back is definitely grateful.\"},\n        {\"category\": \"Furniture\", \"product_name\": \"Ergonomic Chair\", \"review\": \"The meticulous craftsmanship of this chair is evident. Every component, from the armrests to the wheels, feels premium. The adjustability features mean I can tailor it to my needs, ensuring optimal posture and comfort throughout the day.\"},\n        {\"category\": \"Furniture\", \"product_name\": \"Ergonomic Chair\", \"review\": \"I was initially drawn to its aesthetic appeal, but the functional benefits have been profound. The breathable material ensures no discomfort even after prolonged use, and the robust build gives me confidence that it's a chair built to last.\"},\n    ]", "mimetype": "text/plain", "start_char_idx": 463, "end_char_idx": 3954, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b6ac78f9-6a1c-40c0-8f3d-8504dc757ac6": {"__data__": {"id_": "b6ac78f9-6a1c-40c0-8f3d-8504dc757ac6", "embedding": null, "metadata": {"Header_1": " Setting up an In-Memory Database", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17", "node_type": "4", "metadata": {"filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "ff11ebb3d7de32b43dc883b6272a9ff5d0f95926e8f0e37dbe9041b25ea90f9d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "5ec14ed4-c2a2-4d31-89e8-2213dc12279c", "node_type": "1", "metadata": {"Header_1": " Sample Dataset of Product Reviews", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "948169db75e29b754e60ca1c5b0fa187dac2696e9f02c4040facd133eb51a640", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "b484efff-7a3f-431d-a94d-a4eca8dc68ae", "node_type": "1", "metadata": {"Header_1": " Analysing Product Reviews \u2014 Text2SQL + RAG"}, "hash": "3afdb60f43f72e79dc2fb28263f19594e498683ad964d800e40261e8a95689f1", "class_name": "RelatedNodeInfo"}}, "text": "Setting up an In-Memory Database\n\nTo process our data, we\u2019re using an in-memory SQLite database. SQLAlchemy\nprovides an efficient way to model, create, and interact with this database.\nHere\u2019s how our ` product_reviews ` table structure looks:\n\n  * ` id ` (Integer, Primary Key) \n  * ` category ` (String) \n  * ` product_name ` (String) \n  * ` review ` (String, Not Null) \n\nOnce we\u2019ve defined our table structure, we populate it with our sample\ndataset.\n\n    \n    \n    engine = create_engine(\"sqlite:///:memory:\")\n    metadata_obj = MetaData()\n    \n    # create product reviews SQL table\n    table_name = \"product_reviews\"\n    city_stats_table = Table(\n        table_name,\n        metadata_obj,\n        Column(\"id\", Integer(), primary_key=True),\n        Column(\"category\", String(16), primary_key=True),\n        Column(\"product_name\", Integer),\n        Column(\"review\", String(16), nullable=False)\n    )\n    metadata_obj.create_all(engine)\n    \n    sql_database = SQLDatabase(engine, include_tables=[\"product_reviews\"])\n    \n    for row in rows:\n        stmt = insert(city_stats_table).values(**row)\n        with engine.connect() as connection:\n            cursor = connection.execute(stmt)\n            connection.commit()", "mimetype": "text/plain", "start_char_idx": 3959, "end_char_idx": 5180, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "b484efff-7a3f-431d-a94d-a4eca8dc68ae": {"__data__": {"id_": "b484efff-7a3f-431d-a94d-a4eca8dc68ae", "embedding": null, "metadata": {"Header_1": " Analysing Product Reviews \u2014 Text2SQL + RAG", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17", "node_type": "4", "metadata": {"filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "ff11ebb3d7de32b43dc883b6272a9ff5d0f95926e8f0e37dbe9041b25ea90f9d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b6ac78f9-6a1c-40c0-8f3d-8504dc757ac6", "node_type": "1", "metadata": {"Header_1": " Setting up an In-Memory Database", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "fac1c76d7b01b243ffde0a144fe6d030f35e41be71076659512324fa905da802", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7c71d047-50bd-419c-ba5c-5e9c623d40da", "node_type": "1", "metadata": {"Header_1": " Decomposing User Query into Two Phases"}, "hash": "e8c65c861d389b59fde3a782af6f8e3cd650c6507a2287c3f074278a48189ca1", "class_name": "RelatedNodeInfo"}}, "text": "Analysing Product Reviews \u2014 Text2SQL + RAG\n\nDeriving insights from data often requires intricate questioning.\n\nSQL + RAG in LlamaIndex simplifies this by breaking it into a three-step\nprocess:\n\n  1. **Decomposition of the Question:**\n\n  * Primary Query Formation: Frame the main question in natural language to extract preliminary data from the SQL table. \n  * Secondary Query Formation: Construct an auxiliary question to refine or interpret the results of the primary query. \n\n**2\\. Data Retrieval** : Run the primary query using the Text2SQL LlamaIndex\nmodule to obtain the initial set of results.\n\n**3\\. Final Answer Generation:** Use List Index to further refine the results\nbased on the secondary question, leading to the conclusive answer.\n\nLet\u2019s start doing it step by step.", "mimetype": "text/plain", "start_char_idx": 5185, "end_char_idx": 5967, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7c71d047-50bd-419c-ba5c-5e9c623d40da": {"__data__": {"id_": "7c71d047-50bd-419c-ba5c-5e9c623d40da", "embedding": null, "metadata": {"Header_1": " Decomposing User Query into Two Phases", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17", "node_type": "4", "metadata": {"filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "ff11ebb3d7de32b43dc883b6272a9ff5d0f95926e8f0e37dbe9041b25ea90f9d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "b484efff-7a3f-431d-a94d-a4eca8dc68ae", "node_type": "1", "metadata": {"Header_1": " Analysing Product Reviews \u2014 Text2SQL + RAG", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "49c291587192762b52199462abb0753868a778bc0285011e32d2b9256d795432", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "2aea5f0f-026a-4e2f-abd4-905e9ccf2966", "node_type": "1", "metadata": {"Header_1": " Data Retrieval \u2014 Executing the Primary Query"}, "hash": "24b0cd63eb6ca995965961a2906927b7a55e435d01ace174023d01efc5bcb335", "class_name": "RelatedNodeInfo"}}, "text": "Decomposing User Query into Two Phases\n\nWhen working with a relational database, it\u2019s often helpful to break down user\nqueries into more manageable parts. This makes it easier to retrieve accurate\ndata from our database and subsequently process or interpret this data to meet\nthe user\u2019s needs. We\u2019ve designed an approach to decompose queries into two\ndistinct questions by giving an example to ` gpt-3.5-turbo ` model to generate\ntwo distinct questions.\n\nLet\u2019s apply this to the query \u201cGet the summary of reviews of Iphone13\u201d and our\nsystem would generate:\n\n  * Database Query: \u201cRetrieve reviews related to iPhone13 from the table.\u201d \n  * Interpretation Query: \u201cSummarize the retrieved reviews.\u201d \n\nThis approach ensures that we cater to both the data retrieval and data\ninterpretation needs, resulting in more accurate and tailored responses to\nuser queries.\n\n    \n    \n    def generate_questions(user_query: str) -&gt; List[str]:\n      system_message = '''\n      You are given with Postgres table with the following columns.\n    \n      city_name, population, country, reviews.\n    \n      Your task is to decompose the given question into the following two questions.\n    \n      1. Question in natural language that needs to be asked to retrieve results from the table.\n      2. Question that needs to be asked on the top of the result from the first question to provide the final answer.\n    \n      Example:\n    \n      Input:\n      How is the culture of countries whose population is more than 5000000\n    \n      Output:\n      1. Get the reviews of countries whose population is more than 5000000\n      2. Provide the culture of countries\n      '''\n    \n      messages = [\n          ChatMessage(role=\"system\", content=system_message),\n          ChatMessage(role=\"user\", content=user_query),\n      ]\n      generated_questions = llm.chat(messages).message.content.split('\\n')\n    \n      return generated_questions\n    \n    user_query = \"Get the summary of reviews of Iphone13\"\n    \n    text_to_sql_query, rag_query = generate_questions(user_query)", "mimetype": "text/plain", "start_char_idx": 5972, "end_char_idx": 8017, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "2aea5f0f-026a-4e2f-abd4-905e9ccf2966": {"__data__": {"id_": "2aea5f0f-026a-4e2f-abd4-905e9ccf2966", "embedding": null, "metadata": {"Header_1": " Data Retrieval \u2014 Executing the Primary Query", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17", "node_type": "4", "metadata": {"filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "ff11ebb3d7de32b43dc883b6272a9ff5d0f95926e8f0e37dbe9041b25ea90f9d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7c71d047-50bd-419c-ba5c-5e9c623d40da", "node_type": "1", "metadata": {"Header_1": " Decomposing User Query into Two Phases", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "623a02642c0b8d8941be83ccb2eab70355afe590cd125c811280292c249bec7e", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e954c784-87f2-4f3b-b2a1-0b677801ed46", "node_type": "1", "metadata": {"Header_1": " Refining and Interpreting the reviews with ListIndex:"}, "hash": "704bf3f992a8ab7265fd7e7262016c12e18ce199ac1840dc3cb317629438e29b", "class_name": "RelatedNodeInfo"}}, "text": "Data Retrieval \u2014 Executing the Primary Query\n\nWhen we decompose a user\u2019s question into its constituent parts, the first step\nis to convert the \u201cDatabase Query in Natural Language\u201d into an actual SQL\nquery that can be run against our database. In this section, we\u2019ll use the\nLlamaIndex\u2019s ` NLSQLTableQueryEngine ` to handle the conversion and execution\nof this SQL query.\n\n**Setting up the NLSQLTableQueryEngine:**\n\nThe ` NLSQLTableQueryEngine ` is a powerful tool that takes natural language\nqueries and converts them into SQL queries. We initiate this by providing the\nnecessary details:\n\n  * ` sql_database ` : This represents our SQL database connection details. \n  * ` tables ` : We specify which table(s) our query will be run against. In this scenario, we're targeting the ` product_reviews ` table. \n  * ` synthesize_response ` : When set to ` False ` , this ensures we receive raw SQL responses without additional synthesis. \n  * ` service_context ` : This is an optional parameter, which could be used to provide service-specific settings or plugins. \n\n    \n    \n    sql_query_engine = NLSQLTableQueryEngine(\n        sql_database=sql_database,\n        tables=[\"product_reviews\"],\n        synthesize_response=False,\n        service_context=service_context\n    )\n\n**Executing the natural language Query:**\n\nAfter setting up the engine, the next step is executing our natural language\nquery against it. The engine\u2019s ` query() ` method is used for this purpose.\n\n    \n    \n    sql_response = sql_query_engine.query(text_to_sql_query)\n\n**Processing the SQL Response:**\n\nThe result of our SQL query is usually a list of rows (with each row\nrepresented as a list of reviews). To make it more readable and usable for the\nthird step of processing summarizing reviews, we convert this result into a\nsingle string.\n\n    \n    \n    sql_response_list = ast.literal_eval(sql_response.response)\n    text = [' '.join(t) for t in sql_response_list]\n    text = ' '.join(text)\n\nYou can check the generated SQL query in ` sql_response.metadata[\"sql_query\"].\n`\n\nBy following this process, we\u2019re able to seamlessly integrate natural language\nprocessing with SQL query execution. Let\u2019s go with the last step in this\nprocess for getting a summary of the reviews.", "mimetype": "text/plain", "start_char_idx": 8022, "end_char_idx": 10268, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e954c784-87f2-4f3b-b2a1-0b677801ed46": {"__data__": {"id_": "e954c784-87f2-4f3b-b2a1-0b677801ed46", "embedding": null, "metadata": {"Header_1": " Refining and Interpreting the reviews with ListIndex:", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17", "node_type": "4", "metadata": {"filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "ff11ebb3d7de32b43dc883b6272a9ff5d0f95926e8f0e37dbe9041b25ea90f9d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "2aea5f0f-026a-4e2f-abd4-905e9ccf2966", "node_type": "1", "metadata": {"Header_1": " Data Retrieval \u2014 Executing the Primary Query", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "f2b1f043ebcbfeb578749a02827886278c86c6f19cb6605fd1d2dcff36e798b2", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0daca5e2-dca3-45df-b1c7-a201e6e34429", "node_type": "1", "metadata": {"Header_1": " Refining and Interpreting the reviews with ListIndex:", "Header_2": " Examples:"}, "hash": "023a5e0856a947b26ad70f377b37bec1ad6ec12ce892693c44bd7a7f1ebf77d1", "class_name": "RelatedNodeInfo"}}, "text": "Refining and Interpreting the reviews with ListIndex:\n\nAfter obtaining the primary set of results from the SQL query, there are often\nsituations where further refinement or interpretation is required. This is\nwhere ` ListIndex ` from LlamaIndex plays a crucial role. It allows us to\nexecute the secondary question on our obtained text data to get a refined\nanswer.\n\n    \n    \n    listindex = ListIndex([Document(text=text)])\n    list_query_engine = listindex.as_query_engine()\n    \n    response = list_query_engine.query(rag_query)\n    \n    print(response.response)\n\nNow let\u2019s wrap everything under a function and try out a few interesting\nexamples:\n\n    \n    \n    \"\"\"Function to perform SQL+RAG\"\"\"\n    \n    def sql_rag(user_query: str) -&gt; str:\n      text_to_sql_query, rag_query = generate_questions(user_query)\n    \n      sql_response = sql_query_engine.query(text_to_sql_query)\n    \n      sql_response_list = ast.literal_eval(sql_response.response)\n    \n      text = [' '.join(t) for t in sql_response_list]\n      text = ' '.join(text)\n    \n      listindex = ListIndex([Document(text=text)])\n      list_query_engine = listindex.as_query_engine()\n    \n      summary = list_query_engine.query(rag_query)\n    \n      return summary.response", "mimetype": "text/plain", "start_char_idx": 10273, "end_char_idx": 11515, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0daca5e2-dca3-45df-b1c7-a201e6e34429": {"__data__": {"id_": "0daca5e2-dca3-45df-b1c7-a201e6e34429", "embedding": null, "metadata": {"Header_1": " Refining and Interpreting the reviews with ListIndex:", "Header_2": " Examples:", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17", "node_type": "4", "metadata": {"filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "ff11ebb3d7de32b43dc883b6272a9ff5d0f95926e8f0e37dbe9041b25ea90f9d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e954c784-87f2-4f3b-b2a1-0b677801ed46", "node_type": "1", "metadata": {"Header_1": " Refining and Interpreting the reviews with ListIndex:", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "1909fb403453be692c48face535b1bc40ad72cac32286642e5d062d40851b653", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "99025b6b-a30a-4184-b162-6d455de8d4fd", "node_type": "1", "metadata": {"Header_1": " Conclusion"}, "hash": "94d66f8b4cecad608c6ee44277da3234ded1d88a7741d4fc5245ffbb2ebccb91", "class_name": "RelatedNodeInfo"}}, "text": "Examples:\n\n    \n    \n    sql_rag(\"How is the sentiment of SamsungTV product?\")\n\n_The sentiment of the reviews for the Samsung TV product is generally\npositive. Users express satisfaction with the picture clarity, vibrant colors,\nand stunning picture quality. They appreciate the smart features, user-\nfriendly interface, and easy connectivity options. The sleek design and wall-\nmounting capability are also praised. The ambient mode, gaming mode, and HDR\ncontent are mentioned as standout features. Users find the remote control with\nvoice command convenient and appreciate the regular software updates. However,\nsome users mention that the sound quality could be better and suggest using an\nexternal audio system. Overall, the reviews indicate that the Samsung TV is\nconsidered a solid investment for quality viewing._\n\n    \n    \n    sql_rag(\"Are people happy with Ergonomic Chair?\")\n\n_The overall satisfaction of people with the Ergonomic Chair is high._\n\nYou can play around with the approach and dataset in the Google Colab Notebook\n\u2014 [ here ](https://colab.research.google.com/drive/13le_rgEo-\nwaW5ZWjWDEyUf64R6n_4Cez?usp=sharing) .", "mimetype": "text/plain", "start_char_idx": 11521, "end_char_idx": 12659, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "99025b6b-a30a-4184-b162-6d455de8d4fd": {"__data__": {"id_": "99025b6b-a30a-4184-b162-6d455de8d4fd", "embedding": null, "metadata": {"Header_1": " Conclusion", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17", "node_type": "4", "metadata": {"filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "ff11ebb3d7de32b43dc883b6272a9ff5d0f95926e8f0e37dbe9041b25ea90f9d", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0daca5e2-dca3-45df-b1c7-a201e6e34429", "node_type": "1", "metadata": {"Header_1": " Refining and Interpreting the reviews with ListIndex:", "Header_2": " Examples:", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}, "hash": "45bb6f4b08f665d8c71631d14aa21b66db5b3de6958f3ef61cf2e20643df1b19", "class_name": "RelatedNodeInfo"}}, "text": "Conclusion\n\nIn the era of e-commerce, where user reviews dictate the success or failure of\nproducts, the ability to rapidly analyze and interpret vast swaths of textual\ndata is paramount. LlamaIndex, through its ingenious integration of SQL and\nRAG, offers businesses a powerful tool to glean actionable insights from such\ndatasets. By seamlessly blending structured SQL queries with the abstraction\nof natural language processing, we\u2019ve showcased a streamlined approach to\ntransform vague user queries into precise, informative answers.\n\nWith this approach, businesses can now efficiently sift through mountains of\nreviews, extract the essence of user sentiments, and make informed decisions.\nWhether it\u2019s about gauging the overall sentiment for a product, understanding\nspecific feature feedback, or even tracking the evolution of reviews over\ntime, the Text2SQL+RAG methodology in LlamaIndex is the harbinger of a new age\nof data analytics.", "mimetype": "text/plain", "start_char_idx": 12664, "end_char_idx": 13607, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}}, "docstore/metadata": {"23c44ef1-bc1a-4c5a-bed6-8e1432fe4b84": {"doc_hash": "a6eb8fa2963388d9e103d73dac694893072423e2615550dc733bc054bd5ec72e", "ref_doc_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17"}, "5ec14ed4-c2a2-4d31-89e8-2213dc12279c": {"doc_hash": "948169db75e29b754e60ca1c5b0fa187dac2696e9f02c4040facd133eb51a640", "ref_doc_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17"}, "b6ac78f9-6a1c-40c0-8f3d-8504dc757ac6": {"doc_hash": "fac1c76d7b01b243ffde0a144fe6d030f35e41be71076659512324fa905da802", "ref_doc_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17"}, "b484efff-7a3f-431d-a94d-a4eca8dc68ae": {"doc_hash": "49c291587192762b52199462abb0753868a778bc0285011e32d2b9256d795432", "ref_doc_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17"}, "7c71d047-50bd-419c-ba5c-5e9c623d40da": {"doc_hash": "623a02642c0b8d8941be83ccb2eab70355afe590cd125c811280292c249bec7e", "ref_doc_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17"}, "2aea5f0f-026a-4e2f-abd4-905e9ccf2966": {"doc_hash": "f2b1f043ebcbfeb578749a02827886278c86c6f19cb6605fd1d2dcff36e798b2", "ref_doc_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17"}, "e954c784-87f2-4f3b-b2a1-0b677801ed46": {"doc_hash": "1909fb403453be692c48face535b1bc40ad72cac32286642e5d062d40851b653", "ref_doc_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17"}, "0daca5e2-dca3-45df-b1c7-a201e6e34429": {"doc_hash": "45bb6f4b08f665d8c71631d14aa21b66db5b3de6958f3ef61cf2e20643df1b19", "ref_doc_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17"}, "99025b6b-a30a-4184-b162-6d455de8d4fd": {"doc_hash": "aa3157880918a0006930f8254389914b36fb2d7528c702027b095edd423b666c", "ref_doc_id": "e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17"}}, "docstore/ref_doc_info": {"e2cef6ba-4fed-4f6c-af89-ef5a10ddbf17": {"node_ids": ["23c44ef1-bc1a-4c5a-bed6-8e1432fe4b84", "5ec14ed4-c2a2-4d31-89e8-2213dc12279c", "b6ac78f9-6a1c-40c0-8f3d-8504dc757ac6", "b484efff-7a3f-431d-a94d-a4eca8dc68ae", "7c71d047-50bd-419c-ba5c-5e9c623d40da", "2aea5f0f-026a-4e2f-abd4-905e9ccf2966", "e954c784-87f2-4f3b-b2a1-0b677801ed46", "0daca5e2-dca3-45df-b1c7-a201e6e34429", "99025b6b-a30a-4184-b162-6d455de8d4fd"], "metadata": {"Header_1": " Introduction", "filename": "llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b.md", "extension": ".md", "title": "LlamaIndex: Harnessing the Power of Text2SQL and RAG to Analyze Product Reviews", "date": "Aug 12, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-harnessing-the-power-of-text2sql-and-rag-to-analyze-product-reviews-204feabdf25b"}}}}