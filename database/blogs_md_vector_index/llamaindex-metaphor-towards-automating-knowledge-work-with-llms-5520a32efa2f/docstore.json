{"docstore/data": {"fdfb3375-37d7-4f8f-8ed6-8231e03a619d": {"__data__": {"id_": "fdfb3375-37d7-4f8f-8ed6-8231e03a619d", "embedding": null, "metadata": {"filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c46c8e68-9823-4f04-a56b-2df0fd315680", "node_type": "4", "metadata": {"filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "b444e080a00a0f47afc74296304211d3fd007cc0dd92217f1c6934c2818a87ef", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "345df51b-3fbc-4ee9-b705-f921f42526fd", "node_type": "1", "metadata": {"Header_1": " Background/Context"}, "hash": "087ffcb7e28f390e32f871a5ce1d87490f940437931ea71b6edd9e740300660a", "class_name": "RelatedNodeInfo"}}, "text": "(co-authored by Jerry Liu, CEO of LlamaIndex, Jeffrey Wang, co-founder at\nMetaphor, and Adam Hoffman, Software Engineer at Hypotenuse Labs)\n\nWe\u2019re incredibly excited to launch an [ integration\n](https://llamahub.ai/l/tools-metaphor) between LlamaIndex and [ Metaphor\n](https://platform.metaphor.systems/) : combine the capabilities of LlamaIndex\ndata agents with Metaphor as a _native_ LLM search tool to enable knowledge\nworkers capable of answering any question over any data, no matter how recent\nor complex.\n\nWe provide a deeper overview of Metaphor and the LlamaIndex integration below.\nWe also walk through our [ example notebook\n](https://github.com/emptycrown/llama-\nhub/blob/main/llama_hub/tools/notebooks/metaphor.ipynb) to showcase how they\ncan be combined.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 768, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "345df51b-3fbc-4ee9-b705-f921f42526fd": {"__data__": {"id_": "345df51b-3fbc-4ee9-b705-f921f42526fd", "embedding": null, "metadata": {"Header_1": " Background/Context", "filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c46c8e68-9823-4f04-a56b-2df0fd315680", "node_type": "4", "metadata": {"filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "b444e080a00a0f47afc74296304211d3fd007cc0dd92217f1c6934c2818a87ef", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "fdfb3375-37d7-4f8f-8ed6-8231e03a619d", "node_type": "1", "metadata": {"filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "4ea76b285abd344c08d202614cab68c72e6c891c9021333ec5fea18a7f790567", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "0d26f891-ce87-4746-85ad-409d797ddbc5", "node_type": "1", "metadata": {"Header_1": " Overview of Metaphor"}, "hash": "e7110215ffad07edb3905221b93fba861a42d178ddc623f96e99098dfaf8dd03", "class_name": "RelatedNodeInfo"}}, "text": "Background/Context\n\nState-of-the art large language models (LLMs) such as ChatGPT, GPT-4, Claude 2\nhave incredible reasoning capabilities that unlock a wide variety of use cases\n\u2014 from insight extraction to question-answering to general workflow\nautomation. Yet they are limited in their abilities to retrieve contextually\nrelevant information. A popular stack that has emerged is to setup a\nretrieval-augmented generation (RAG) system, which combines LLMs with external\nstorage solutions over a static knowledge source. Frameworks such as\nLlamaIndex provide a variety of tools to setup both simple and complex RAG\nsystems.\n\nYet even this is not the complete picture. LLMs should ideally be able to\ndynamically search and retrieve information from the external world, not just\ndepend on a static source of knowledge. This would allow them to fulfill a\nmore general set of tasks and not only perform search/retrieval, but perform\nactions as well.\n\nTo do this well, we need two core components:\n\n  * General abstractions that allow LLMs to intelligently perform various tasks over your data, in both a \u201cread\u201d and \u201cwrite\u201d fashion \n  * A good search engine tailored for LLM use \n\nLlamaIndex [ data agent abstractions ](https://medium.com/llamaindex-\nblog/data-agents-eed797d7972f) help to satisfy the first core component. A\ncomplete data agent consists of both a reasoning loop as well as a set of\nTools. These tools can be interfaces for search/retrieval or more generally\nany external API. Given a query, the agent will execute its reasoning loop and\ndynamically figure out the set of Tools it will need to fulfill the task at\nhand.\n\nData agents have access to a rich set of Tools offered on [ LlamaHub\n](https://llamahub.ai/) \u2014 these range from Gmail API, to a SQL db API, to a\nbasic tool in the form of Bing search. We\u2019ve shown that they are capable of\ne2e tasks from [ sending emails ](https://github.com/emptycrown/llama-\nhub/blob/main/llama_hub/tools/notebooks/gmail.ipynb) , [ scheduling meetings\n](https://github.com/emptycrown/llama-\nhub/blob/main/llama_hub/tools/notebooks/google_calendar.ipynb) , to automating\n[ custom support insight extraction ](https://github.com/emptycrown/llama-\nhub/blob/main/llama_hub/tools/notebooks/shopify.ipynb) . Yet there has never\nbeen a tool tailored for LLM use.", "mimetype": "text/plain", "start_char_idx": 773, "end_char_idx": 3078, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "0d26f891-ce87-4746-85ad-409d797ddbc5": {"__data__": {"id_": "0d26f891-ce87-4746-85ad-409d797ddbc5", "embedding": null, "metadata": {"Header_1": " Overview of Metaphor", "filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c46c8e68-9823-4f04-a56b-2df0fd315680", "node_type": "4", "metadata": {"filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "b444e080a00a0f47afc74296304211d3fd007cc0dd92217f1c6934c2818a87ef", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "345df51b-3fbc-4ee9-b705-f921f42526fd", "node_type": "1", "metadata": {"Header_1": " Background/Context", "filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "e52004e02cd2503a464d2ffab61f3e8ce0130104ea858a42007dd534453ee46d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7cf5e484-90ba-43b5-ad18-9f52f100ec0e", "node_type": "1", "metadata": {"Header_1": " Integration Details"}, "hash": "628a949021573f73afb9a2e918616ae0051d19259b91b5029da075bc2a73d44c", "class_name": "RelatedNodeInfo"}}, "text": "Overview of Metaphor\n\nThe Metaphor API is designed to connect your LLM to the internet. It allows\nyou to perform fully neural, highly semantic searches over the Internet and\nalso get clean, HTML content from the results.\n\nMetaphor was trained to predict links on the internet, given how people talk\nabout things on the Internet. For example, someone might post about a great\narticle they read like this:\n\n> Found an amazing article I read about the history of Rome\u2019s architecture:\n> [LINK]\n\nBy training a model to predict these links given how people talk about them,\nthe end result is a totally different way to search the internet \u2014 _search as\nif you\u2019re about to share the link you want_ . While a little unintuitive at\nfirst, searching this way can return extremely high quality results. But for\nthe purposes of LlamaIndex, you won\u2019t need to worry about this because by\ndefault, queries will be converted into Metaphor prompts.\n\nWhy would you use Metaphor Search over Bing/Google? There are 3 main reasons:\n\n  * You can search fully semantically, for instance with feelings or complex descriptors. \n  * You can search only for the type of entity that you want. Companies, articles, people. \n  * You can find content that Google simply doesn\u2019t surface well, maybe because keywords aren\u2019t the right tool or maybe just because Google doesn\u2019t care about returning good results for that type of content. \n\nTo learn more, you can read the full Metaphor API [ blog post\n](https://platform.metaphor.systems/blog/building-search-for-the-post-chatgpt-\nworld) .", "mimetype": "text/plain", "start_char_idx": 3083, "end_char_idx": 4636, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7cf5e484-90ba-43b5-ad18-9f52f100ec0e": {"__data__": {"id_": "7cf5e484-90ba-43b5-ad18-9f52f100ec0e", "embedding": null, "metadata": {"Header_1": " Integration Details", "filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c46c8e68-9823-4f04-a56b-2df0fd315680", "node_type": "4", "metadata": {"filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "b444e080a00a0f47afc74296304211d3fd007cc0dd92217f1c6934c2818a87ef", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "0d26f891-ce87-4746-85ad-409d797ddbc5", "node_type": "1", "metadata": {"Header_1": " Overview of Metaphor", "filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "86e26b797f1187bfa9bea30540191764101a253cd92b316bc64677f2f54fca6a", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "31e6377d-5640-43e9-8913-c63525151d01", "node_type": "1", "metadata": {"Header_1": " Example Walkthrough"}, "hash": "fe2cd05457474a9926a5f3f0cf3f89f7ae6dd35d031b142b30b58980ef0c954f", "class_name": "RelatedNodeInfo"}}, "text": "Integration Details\n\nThe [ Metaphor Tool Spec in LlamaHub ](https://llamahub.ai/l/tools-metaphor)\nis an API interface that consists of 5 tools that an agent can use.\n\n  * **Search:** The entrypoint to Metaphor \u2014 allows an agent to pass a natural language query that will then be passed to the Metaphor search engine. This endpoint also contains some additional parameters, such as the number of results, domains to include/exclude, and a date filter. \n  * **Retrieve Documents:** This will retrieve the content of a set of documents given IDs. These ids are returned as part of the results from the search endpoint above. \n  * **Search and Retrieve Documents:** This is a convenience endpoint that combines the functionality of `search` and `retrieve_documents`. \n  * **Find Similar:** This directly calls an endpoint offered by Metaphor, which will return a list of documents similar to a given URL. \n  * **Current Date:** This is a convenience function that returns the current date. On its own it is unrelated to Metaphor\u2019s API, but may be called beforehand to figure out the right date filters to pass to some of Metaphor\u2019s endpoints. \n\nIn the next section, let\u2019s walk through how a data agent can make use of these\nendpoints through various use cases.", "mimetype": "text/plain", "start_char_idx": 4641, "end_char_idx": 5897, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "31e6377d-5640-43e9-8913-c63525151d01": {"__data__": {"id_": "31e6377d-5640-43e9-8913-c63525151d01", "embedding": null, "metadata": {"Header_1": " Example Walkthrough", "filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c46c8e68-9823-4f04-a56b-2df0fd315680", "node_type": "4", "metadata": {"filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "b444e080a00a0f47afc74296304211d3fd007cc0dd92217f1c6934c2818a87ef", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7cf5e484-90ba-43b5-ad18-9f52f100ec0e", "node_type": "1", "metadata": {"Header_1": " Integration Details", "filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "36ac1c3673a26358b7dd673474a8909d0f50e376b17be060cf6c33e735cf79a6", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "321aa32f-e838-45d4-af8d-45192fcaa24a", "node_type": "1", "metadata": {"Header_1": " Conclusion"}, "hash": "6f0babba392cf6cd7b8387d6295cb55dcfa67a0ffeb9d949928ee71fcfe4205a", "class_name": "RelatedNodeInfo"}}, "text": "Example Walkthrough\n\nLet\u2019s walk through our example notebook showing how LlamaIndex data agents can\nbe used with Metaphor.\n\n**Testing the Metaphor Tools**\n\nThe first step is to import the Metaphor tool spec.\n\n    \n    \n    # Set up Metaphor tool\n    from llama_hub.tools.metaphor.base import MetaphorToolSpec\n    metaphor_tool = MetaphorToolSpec(\n    api_key='your-key',\n    )\n    # convert tool spec to a list of tools\n    metaphor_tool_list = metaphor_tool.to_tool_list()\n    for tool in metaphor_tool_list:\n    print(tool.metadata.name)\n\nIn this walkthrough, we make use of all of the tools. But you\u2019re free to pick\nand choose to use specific tools if you want to define a more custom workflow\nand restrict the agent action space.\n\nWe can play around with the set of tools before defining our agent. All of our\nMetaphor tools make use of the `AutoPrompt` option where Metaphor will pass a\nquery through an LLM to refine and improve the query.\n\nExample input:\n\n    \n    \n    metaphor_tool.search('machine learning transformers', num_results=3)\n\nExample output:\n\n    \n    \n    [{'title': 'On the potential of Transformers in Reinforcement Learning',\n    'url': 'https://lorenzopieri.com/rl_transformers/',\n    'id': 'ysJlYSgeGW3l4zyOBoSGcg'},\n    {'title': 'Transformers: Attention in Disguise',\n    'url': 'https://www.mihaileric.com/posts/transformers-attention-in-disguise/',\n    'id': 'iEYMai5rS9k0hN5_BH0VZg'},\n    {'title': 'Transformers in Computer Vision: Farewell Convolutions!',\n    'url': 'https://towardsdatascience.com/transformers-in-computer-vision-farewell-convolutions-f083da6ef8ab?gi=a1d0a9a2896c',\n    'id': 'kX1Z89DdjSvBrH1S1XLvwg'}]\n\nThe notebook also contains examples of us playing around with the other\nendpoints: ` retrieve_documents ` , ` find_similar ` , `\nsearch_and_retrieve_documents ` .\n\n**Setting up an OpenAI Function Calling Agent with Metaphor**\n\nWe can create an agent with access to all of the above tools and start testing\nit out:\n\n    \n    \n    from llama_index.agent import OpenAIAgent\n    # We don't give the Agent our unwrapped retrieve document tools, instead passing the wrapped tools\n    agent = OpenAIAgent.from_tools(\n      metaphor_tool_list,\n      verbose=True,\n    )\n\nThat\u2019s it in terms of setup! Let\u2019s try giving an example query:\n\n    \n    \n    print(agent.chat('What are the best restaurants in toronto?\"))\n\nWe walk through the execution trace of this agent to see how it is interacting\nwith the Metaphor tool.\n\n    \n    \n    === Calling Function ===\n    Calling function: search with args: {\n      \"query\": \"best restaurants in Toronto\"\n    }\n    [Metaphor Tool] Autoprompt string: Here's a link to the best restaurant in Toronto:\n    Got output: [{'title': 'Via Allegro Ristorante - Toronto Fine Dining Restaurant', 'url': 'https://viaallegroristorante.com/', 'id': 'EVlexzJh-lzkVr4tb2y_qw'}, {'title': 'The Senator \u2013 Home', 'url': 'https://thesenator.com/', 'id': 'dA3HVr5P8E0Bs7nH2gH7ZQ'}, {'title': 'Home - The Rushton', 'url': 'https://therushton.com/', 'id': '6Je-igG-i-ApqISC5XXmGQ'}, {'title': 'Location', 'url': 'https://osteriagiulia.ca/', 'id': 'HjP5c54vqb3n3UNa3HevSA'}, {'title': 'StockYards | Stockyards Toronto', 'url': 'https://www.thestockyards.ca/', 'id': 'Pffz-DQlOepqVgKQDmW5Ig'}, {'title': 'Select A Restaurant', 'url': 'https://www.torontopho.com/', 'id': 'DiQ1hU1gmrIzpKnOaVvZmw'}, {'title': 'Home | Kit Kat Italian Bar &amp; Grill', 'url': 'http://www.kitkattoronto.com/', 'id': 'kdAcLioBgnwzuHyd0rWS1w'}, {'title': 'La Fenice', 'url': 'https://www.lafenice.ca/', 'id': 'M-LHQZP6V40V81fqLFAQxQ'}, {'title': 'Le Ph\u00e9nix', 'url': 'https://www.lephenixto.com/', 'id': 'spCTcFr0GHlFUTzyngfRVw'}, {'title': 'ITALIAN, INSPIRED.', 'url': 'https://figotoronto.com/', 'id': 'OvBcTqEo1tCSywr4ATptCg'}]\n    ========================\n    Here are some of the best restaurants in Toronto:\n    \n    1. [Via Allegro Ristorante](https://viaallegroristorante.com/)\n    2. [The Senator](https://thesenator.com/)\n    3. [The Rushton](https://therushton.com/)\n    4. [Osteria Giulia](https://osteriagiulia.ca/)\n    5. [Stockyards](https://www.thestockyards.ca/)\n    6. [Toronto Pho](https://www.torontopho.com/)\n    7. [Kit Kat Italian Bar &amp; Grill](http://www.kitkattoronto.com/)\n    8. [La Fenice](https://www.lafenice.ca/)\n    9. [Le Ph\u00e9nix](https://www.lephenixto.com/)\n    10. [Figo](https://figotoronto.com/)\n    \n    You can visit their websites for more information. Enjoy your dining experience in Toronto!\n\nThe execution trace shows that the agent is simply calling the `search`\nendpoint with \u201cbest restaurants in Toronto\u201d, and returning that as a list of\ndictionaries representing the search results.\n\nNote that we can ask a followup question as well:\n\n    \n    \n    print(agent.chat('tell me more about Osteria Giulia'))\n\nAnd we get the following result (note: we truncate some of the intermediate\noutput):\n\n    \n    \n    === Calling Function ===\n    Calling function: retrieve_documents with args: {\n    \"ids\": [\"HjP5c54vqb3n3UNa3HevSA\"]\n    }\n    Got output: [\u2026]\n    ========================\n    Osteria Giulia is a restaurant located at 134 Avenue Road in Toronto, Ontario. You can contact them at 416.964.8686 or via email at info@osteriagiulia.ca (for general inquiries only, no reservation requests via email).\n    The restaurant's operating hours are from Monday to Saturday, from 5:00pm to 11:00pm. On Sundays, the restaurant is available for private bookings.\n    Parking is available on Avenue Road and Davenport Road.\n    You can follow Osteria Giulia on Instagram [@osteriagiulia](https://www.instagram.com/osteriagiulia). They also have a sister restaurant called Giulietta, which you can visit at [giu.ca](https://giu.ca) or on Instagram [@giulietta972](https://www.instagram.com/giulietta972).\n    Please note that the information provided is based on the available document and may be subject to change. It is recommended to visit their official website or contact them directly for the most up-to-date information.\n\nSince \u201cOsteria Giulia\u201d is in the agent conversation history, the agent now\nknows to call the `retrieve` endpoint to return more information about the\nrelevant search result.\n\n**Advanced: Avoiding Context Window Issues**\n\nOne issue with using ` retrieve ` is that the content can be quite long. If\nthe content is naively appended to the conversation history and dumped into\nthe LLM context window, then we may run into context window limitations.\n\nLlamaIndex offers tool abstractions to help deal with this. Our `\nLoadAndSearchToolSpec ` wraps any given tool that may return a large amount of\ndata, and it splits it into two tools: a load tool that will dynamically store\nthe data in an index, and a search tool that allows for search over that\nindex.\n\nOn the Metaphor side, this is also where we define a `\nsearch_and_retrieve_documents ` endpoint that combines ` search ` and `\nretrieve ` . This allows the agent to make a single query to retrieve a large\nnumber of documents, which when combined with the ` LoadAndSearchToolSpec `\nwill get directly stored within an index. If the agent were to call ` search `\nand ` retrieve ` separately, then it would both take longer and consume more\ntokens to write the search results to conversation history, and then passing\nthat into the prompt again to call ` retrieve ` over all document IDs.\n\nCreating the ` LoadAndSearchToolSpec ` :\n\n    \n    \n    from llama_index.tools.tool_spec.load_and_search.base import LoadAndSearchToolSpec\n    # The search_and_retrieve_documents tool is the third in the tool list, as seen above\n    wrapped_retrieve = LoadAndSearchToolSpec.from_defaults(\n      metaphor_tool_list[2],\n    )\n\nNow let\u2019s walk through a full execution example:\n\n    \n    \n    # Just pass the wrapped tools and the get_date utility\n    agent = OpenAIAgent.from_tools(\n      [*wrapped_retrieve.to_tool_list(), metaphor_tool_list[4]],\n      verbose=True,\n    )\n    print(agent.chat('Can you summarize everything published in the last month regarding news on superconductors'))\n\nThe output here shows that the agent calls multiple tools in succession to get\nthe right answer.\n\n    \n    \n    === Calling Function ===\n    Calling function: current_date with args: {}\n    Got output: 2023-08-20\n    ========================\n    === Calling Function ===\n    Calling function: search_and_retrieve_documents with args: {\n      \"query\": \"superconductors\",\n      \"start_published_date\": \"2023-07-20\",\n      \"end_published_date\": \"2023-08-20\"\n    }\n    [Metaphor Tool] Autoprompt: \"Here is an interesting article about superconductors:\n    Got output: Content loaded! You can now search the information using read_search_and_retrieve_documents\n    ========================\n    === Calling Function ===\n    Calling function: read_search_and_retrieve_documents with args: {\n      \"query\": \"superconductors\"\n    }\n    Got output: \n    Superconductors are materials that can perfectly conduct electricity. They are used in a variety of applications, such as particle accelerators, nuclear fusion devices, MRI machines, and maglev trains. However, so far, no superconductor has been proven to work at ambient pressures and temperatures. On July 22, scientists in South Korea published research claiming to have solved this problem with a material called LK-99, which has an electrical resistivity that drops to near zero at 30 degrees Celsius (86 degrees Fahrenheit).\n    ========================\n    In the last month, there have been developments in the field of superconductors. Scientists in South Korea have published research on a material called LK-99, which has the ability to conduct electricity with near-zero resistance at a temperature of 30 degrees Celsius (86 degrees Fahrenheit). This breakthrough could potentially lead to the development of superconductors that work at ambient pressures and temperatures, opening up new possibilities for various applications such as particle accelerators, nuclear fusion devices, MRI machines, and maglev trains.\n\nThe agent used the ` get_date ` tool to determine the current month, and then\napplied the filters in Metaphor based on publication date when calling `\nsearch ` . It then loaded the documents using ` retrieve_documents ` and read\nthem using ` read_retrieve_documents ` .", "mimetype": "text/plain", "start_char_idx": 5902, "end_char_idx": 16175, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "321aa32f-e838-45d4-af8d-45192fcaa24a": {"__data__": {"id_": "321aa32f-e838-45d4-af8d-45192fcaa24a", "embedding": null, "metadata": {"Header_1": " Conclusion", "filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "c46c8e68-9823-4f04-a56b-2df0fd315680", "node_type": "4", "metadata": {"filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "b444e080a00a0f47afc74296304211d3fd007cc0dd92217f1c6934c2818a87ef", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "31e6377d-5640-43e9-8913-c63525151d01", "node_type": "1", "metadata": {"Header_1": " Example Walkthrough", "filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}, "hash": "1a2549f61ecd3b3f3cc8b1da84beb82140ec33b2bc71e7f58dce61ce0d762ca2", "class_name": "RelatedNodeInfo"}}, "text": "Conclusion\n\nAs shown above, the integration between LlamaIndex data agents + Metaphor\nsearch has the potential to bypass existing limitations with LLMs and even RAG\nsystems. We\u2019re excited to continue exploring this further in future blog\nposts.\n\nWe encourage you to play around with the notebook \u2014 make sure to check it out!\n\n**Resources:**\n\n  * Notebook: [ https://github.com/emptycrown/llama-hub/blob/main/llama_hub/tools/notebooks/metaphor.ipynb ](https://github.com/emptycrown/llama-hub/blob/main/llama_hub/tools/notebooks/metaphor.ipynb)\n  * LlamaHub: [ https://llamahub.ai/l/tools-metaphor ](https://llamahub.ai/l/tools-metaphor)\n  * Metaphor: [ https://platform.metaphor.systems/ ](https://platform.metaphor.systems/)\n  * Metaphor API Docs: [ https://docs.metaphor.systems/ ](https://docs.metaphor.systems/)", "mimetype": "text/plain", "start_char_idx": 16180, "end_char_idx": 16994, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}}, "docstore/metadata": {"fdfb3375-37d7-4f8f-8ed6-8231e03a619d": {"doc_hash": "4ea76b285abd344c08d202614cab68c72e6c891c9021333ec5fea18a7f790567", "ref_doc_id": "c46c8e68-9823-4f04-a56b-2df0fd315680"}, "345df51b-3fbc-4ee9-b705-f921f42526fd": {"doc_hash": "e52004e02cd2503a464d2ffab61f3e8ce0130104ea858a42007dd534453ee46d", "ref_doc_id": "c46c8e68-9823-4f04-a56b-2df0fd315680"}, "0d26f891-ce87-4746-85ad-409d797ddbc5": {"doc_hash": "86e26b797f1187bfa9bea30540191764101a253cd92b316bc64677f2f54fca6a", "ref_doc_id": "c46c8e68-9823-4f04-a56b-2df0fd315680"}, "7cf5e484-90ba-43b5-ad18-9f52f100ec0e": {"doc_hash": "36ac1c3673a26358b7dd673474a8909d0f50e376b17be060cf6c33e735cf79a6", "ref_doc_id": "c46c8e68-9823-4f04-a56b-2df0fd315680"}, "31e6377d-5640-43e9-8913-c63525151d01": {"doc_hash": "1a2549f61ecd3b3f3cc8b1da84beb82140ec33b2bc71e7f58dce61ce0d762ca2", "ref_doc_id": "c46c8e68-9823-4f04-a56b-2df0fd315680"}, "321aa32f-e838-45d4-af8d-45192fcaa24a": {"doc_hash": "aff26fb88e327455089b0bf7e12e0e70fbf8794c186ca7a066bb96ab35d5d437", "ref_doc_id": "c46c8e68-9823-4f04-a56b-2df0fd315680"}}, "docstore/ref_doc_info": {"c46c8e68-9823-4f04-a56b-2df0fd315680": {"node_ids": ["fdfb3375-37d7-4f8f-8ed6-8231e03a619d", "345df51b-3fbc-4ee9-b705-f921f42526fd", "0d26f891-ce87-4746-85ad-409d797ddbc5", "7cf5e484-90ba-43b5-ad18-9f52f100ec0e", "31e6377d-5640-43e9-8913-c63525151d01", "321aa32f-e838-45d4-af8d-45192fcaa24a"], "metadata": {"filename": "llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f.md", "extension": ".md", "title": "LlamaIndex + Metaphor: Towards Automating Knowledge Work with LLMs", "date": "Aug 21, 2023", "url": "https://www.llamaindex.ai/blog/llamaindex-metaphor-towards-automating-knowledge-work-with-llms-5520a32efa2f"}}}}