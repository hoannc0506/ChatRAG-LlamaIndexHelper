{"docstore/data": {"8754d684-ffb0-4d01-a726-bfeb8d0b7cfd": {"__data__": {"id_": "8754d684-ffb0-4d01-a726-bfeb8d0b7cfd", "embedding": null, "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "195745e2-1bea-4ad4-9246-5c941fe72cef", "node_type": "1", "metadata": {"Header_2": " PII: What? Why?"}, "hash": "74633360f4cccef90fde8a61c33b39101bbb2af8d246e140e9a1be3751618d7a", "class_name": "RelatedNodeInfo"}}, "text": "A couple of days ago at the DataStax HQ, I had the chance to participate at\nthe LlamaIndex RAG-A-THON. Over the span of the weekend, we had to implement a\nsolution that leverages Retrieval Augmented Generation (RAG) technique.\n\nBecause of my background in cybersecurity, I was leaning towards the security\npitfalls and obstacles of the RAG technique. One of the first things that came\nto mind was the fact that a lot of the unstructured data used is unsanitized\nand can contain sensitive data.", "mimetype": "text/plain", "start_char_idx": 0, "end_char_idx": 493, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "195745e2-1bea-4ad4-9246-5c941fe72cef": {"__data__": {"id_": "195745e2-1bea-4ad4-9246-5c941fe72cef", "embedding": null, "metadata": {"Header_2": " PII: What? Why?", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "8754d684-ffb0-4d01-a726-bfeb8d0b7cfd", "node_type": "1", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "5e1dceb56189bb2ed4753b846ee85dbd9ed4ce6931477f5c03c8eb13859304ed", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "118f4977-267c-40b1-9f8e-c2dce115affe", "node_type": "1", "metadata": {"Header_2": " PII in RAG"}, "hash": "90db68d4a836d6fb785f2f86eafe66c6e6ef00080134d0371bbe82ab1074eaa8", "class_name": "RelatedNodeInfo"}}, "text": "PII: What? Why?\n\nPII stands for Personally Identifiable Information. It refers to any\ninformation that can be used to identify a specific individual. This can be\nnames, addresses, phone numbers, email addresses, social security numbers, and\nfinancial information.\n\nThere are a couple of reasons why handling PIIs is important:\n\n  1. **Privacy:** PII often includes sensitive and private details (like addresses), so protecting it preserves customers\u2019 privacy. \n  2. **Identity Theft:** PII can also lead to identity theft (e.g. one\u2019s social security number gets compromised). \n  3. **Legal Compliance:** Protecting PII is also the law. Many countries and regions have enacted laws and regulations that require organizations to protect PII. GDPR (General Data Protection Regulation) in the EU or HIPAA (Health Insurance Portability and Accountability Act) in the United States govern the way we handle PII. \n  4. **Trust and Reputation:** A data breach or mishandling of PII will severely damage one\u2019s reputation and trust. \n  5. **Financial Security:** PII may include financial information, such as credit card numbers and banking details. Compromised PII can lead to fraudulent transactions. \n  6. **National Security Concerns:** All of the above are crucial in sovereign environments.", "mimetype": "text/plain", "start_char_idx": 499, "end_char_idx": 1786, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "118f4977-267c-40b1-9f8e-c2dce115affe": {"__data__": {"id_": "118f4977-267c-40b1-9f8e-c2dce115affe", "embedding": null, "metadata": {"Header_2": " PII in RAG", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "195745e2-1bea-4ad4-9246-5c941fe72cef", "node_type": "1", "metadata": {"Header_2": " PII: What? Why?", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "d4b077ca96769bfbca149864554d210b1c54a925efd05c9341cce97090aeff3c", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "398eb621-2a13-47d7-89d4-574f129bb4c0", "node_type": "1", "metadata": {"Header_2": " PII in RAG", "Header_3": " Model"}, "hash": "8ebe1bd994ebf9b3d528a0431d8d9e3d5a0f3635432bf0106e24e353efe1cd41", "class_name": "RelatedNodeInfo"}}, "text": "PII in RAG\n\nEverything listed is applicable to almost all applications leveraging RAG.\nRemember that the RAG technique contains two components \u2014 the model and the\nvector database. For this reason, each of these components need to address\nPII.", "mimetype": "text/plain", "start_char_idx": 1793, "end_char_idx": 2035, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "398eb621-2a13-47d7-89d4-574f129bb4c0": {"__data__": {"id_": "398eb621-2a13-47d7-89d4-574f129bb4c0", "embedding": null, "metadata": {"Header_2": " PII in RAG", "Header_3": " Model", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "118f4977-267c-40b1-9f8e-c2dce115affe", "node_type": "1", "metadata": {"Header_2": " PII in RAG", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "01a27a3706212263c38fec7c0cc91d7c94e310b5154a9f20a5f4b2692dd9850b", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "54646341-5737-4ac1-9c69-cf4364ae77cc", "node_type": "1", "metadata": {"Header_2": " PII in RAG", "Header_3": " Vector Database"}, "hash": "d4081082e9f0f517e03eaace1e2fa34b53ee352edbb9c7b3b3a9ce03e27c2815", "class_name": "RelatedNodeInfo"}}, "text": "Model\n\nLanguage models, are trained on large datasets that may contain real-world\ndata, potentially including PII and customer data. When the models generate\ntext, there is a risk that they\u2019ll produce content that includes PII. This is\neven more crucial if you\u2019re creating a multi-tenant application, and you want\nto prevent data leak. This risk can be mitigated by either filtering or\nanonymizing the response. Training the models on anonymized data that is\nstripped of any sensitive information is the better approach to prevent leaks\nof PII.", "mimetype": "text/plain", "start_char_idx": 2042, "end_char_idx": 2586, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "54646341-5737-4ac1-9c69-cf4364ae77cc": {"__data__": {"id_": "54646341-5737-4ac1-9c69-cf4364ae77cc", "embedding": null, "metadata": {"Header_2": " PII in RAG", "Header_3": " Vector Database", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "398eb621-2a13-47d7-89d4-574f129bb4c0", "node_type": "1", "metadata": {"Header_2": " PII in RAG", "Header_3": " Model", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "0d19f7b8d8a3e384048e39911a2a650634bfaecb84590b081b7de0ff1c79176d", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "ebd765b0-8125-4916-8a45-474ce23fff5d", "node_type": "1", "metadata": {"Header_2": " Introducing: Presidio"}, "hash": "7eaba50ade6b648b8cc40a13c38c15f147b649d1763ce84005f0aaeec27c0e8b", "class_name": "RelatedNodeInfo"}}, "text": "Vector Database\n\nVector databases, just like regular databases should not persist sensitive\ninformation plainly. This kind of information should only be persisted using\nencryption, hashing, salt and access controls. Having said that, one should\nalso make sure that the similarity search returned by the Database won\u2019t\nretrieve personal data.\n\nOn top of that, various regulations such as GDPR and HIPAA still apply here.\nSo, if the original data contain PII, you might need to add another instance\nin Europe or any additional region in accordance with regulations. Persisted\ndata should be encrypted or hashed (and additionally salted).", "mimetype": "text/plain", "start_char_idx": 2593, "end_char_idx": 3228, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "ebd765b0-8125-4916-8a45-474ce23fff5d": {"__data__": {"id_": "ebd765b0-8125-4916-8a45-474ce23fff5d", "embedding": null, "metadata": {"Header_2": " Introducing: Presidio", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "54646341-5737-4ac1-9c69-cf4364ae77cc", "node_type": "1", "metadata": {"Header_2": " PII in RAG", "Header_3": " Vector Database", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "a67c6ca8f98f518a7b0161d3633971695656b337890827331a7840fc8ea69023", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e2e98001-7d78-495d-a324-7704fd2a074b", "node_type": "1", "metadata": {"Header_2": " Introducing: Presidio", "Header_3": " How Does Presidio Work?"}, "hash": "dc4079abd6c34a9bfb8ee8ce90dcec2b990cfaddeca55b04d71c13f90ca0c7f6", "class_name": "RelatedNodeInfo"}}, "text": "Introducing: Presidio\n\n[ Presidio ](https://microsoft.github.io/presidio/) is an open-source library\nmaintained by Microsoft (see our [ GitHub\n](https://github.com/microsoft/presidio) repo). It\u2019s derived from the Latin\nword praesidium which means \u201cprotection\u201d or garrison.\n\n  * It enables organizations to preserve privacy using a unified SDK. \n  * It provides fast **_identification_ ** and **_anonymization_ ** modules for private entities in text and images such as credit card numbers, names, locations, social security numbers, bitcoin wallets, US phone numbers, financial data and more. \n\n_Disclaimer: Nothing is bulletproof. It\u2019s your responsibility to make sure\nsensitive data is anonymized._", "mimetype": "text/plain", "start_char_idx": 3234, "end_char_idx": 3934, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e2e98001-7d78-495d-a324-7704fd2a074b": {"__data__": {"id_": "e2e98001-7d78-495d-a324-7704fd2a074b", "embedding": null, "metadata": {"Header_2": " Introducing: Presidio", "Header_3": " How Does Presidio Work?", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "ebd765b0-8125-4916-8a45-474ce23fff5d", "node_type": "1", "metadata": {"Header_2": " Introducing: Presidio", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "8669ceaed21feded1caf6d84825443b0d729c2b6d79add3a76c9f675686368e8", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "f3365154-ef8d-4c07-bb32-3a9d7e7d9a20", "node_type": "1", "metadata": {"Header_2": " Introducing: Presidio", "Header_3": " LlamaIndex Post Processors"}, "hash": "c9e34daf264a70e91c902fbf97359cf9ed6b4b985a1de7461dca4f9bd6d657cf", "class_name": "RelatedNodeInfo"}}, "text": "How Does Presidio Work?\n\n  1. **Predefined** or **custom PII recognizers** leverage _Named Entity Recognition (NER)_ , _regular expressions_ , _rule-based logic_ and _checksum_ (e.g. bitcoin address validation). \n  2. It\u2019s extensible, so you can add your own entities and your own detection mechanisms. \n  3. It\u2019s customizable, so you can create your own anonymizers, and exclude/include certain entities (e.g. exclude anonymization of geographical locations).", "mimetype": "text/plain", "start_char_idx": 3941, "end_char_idx": 4401, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "f3365154-ef8d-4c07-bb32-3a9d7e7d9a20": {"__data__": {"id_": "f3365154-ef8d-4c07-bb32-3a9d7e7d9a20", "embedding": null, "metadata": {"Header_2": " Introducing: Presidio", "Header_3": " LlamaIndex Post Processors", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e2e98001-7d78-495d-a324-7704fd2a074b", "node_type": "1", "metadata": {"Header_2": " Introducing: Presidio", "Header_3": " How Does Presidio Work?", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "975185a2bdaf40963fc9ce7e5b11464f95d96e79550847de8a42d02bfac47893", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "e36ea861-b5c1-4721-b088-169ab15d74aa", "node_type": "1", "metadata": {"Header_2": " Integrating Presidio with LlamaIndex"}, "hash": "1ae40a6e5af214cbb4063887a4a03748b5b09730869ef52b47308af330267b9f", "class_name": "RelatedNodeInfo"}}, "text": "LlamaIndex Post Processors\n\nThere was already some PII integration using NER models and LLMs! These were\nimplemented as post processors that run in the end of the pipeline:\n\n    \n    \n    from llama_index.postprocessor import NERPIINodePostprocessor\n    from llama_index import ServiceContext\n    from llama_index.schema import TextNode\n    \n    text = \"\"\"\n    My name is Roey Ben Chaim and my credit card number is 4095-2609-9393-4932. \n    My email is robo@presidio.site and I live in Amsterdam.\n    Have you been to a P\u00e1lmi Einarsson concert before?\n    What is the limit for card 4158112277712? My IBAN is GB90YNTU67299444055881. \n    What's your last name? Bob, it's Bob.\n    My great great grandfather was called Yulan Peres, \n    and my great great grandmother was called Jennifer Holst\n    I can't browse to your site, keep getting address 179.177.214.91 blocked error\n    Just posted a photo https://www.FilmFranchise.dk/\n    \"\"\"\n    \n    node = TextNode(text=text)\n    \n    service_context = ServiceContext.from_defaults()\n    processor = NERPIINodePostprocessor(service_context=service_context)\n    \n    from llama_index.schema import NodeWithScore\n    \n    new_nodes = processor.postprocess_nodes([NodeWithScore(node=node)])\n    print(new_nodes[0].node.get_text())\n\nRunning the above code resulted in the following:\n\n    \n    \n    My name is [PER_12] and my credit card number is 4095-2609-9393-4932. \n    My email is robo@presidio.site and I live in [LOC_123].\n    Have you been to a [PER_153] concert before?\n    What is the limit for card 4158112277712? My IBAN is GB90YNTU67299444055881. \n    What's your last name? [PER_286], it's [PER_286].\n    My great great grandfather was called [PER_339], \n    and my great great grandmother was called [PER_395]\n    I can't browse to your site, keep getting address 179.177.214.91 blocked error\n    Just posted a photo https://www.[ORG_521].dk/\n\nAs can be seen in this example, while NER models do a decent job in detecting\nPII, they might miss some entities such as IBAN code, credit card numbers,\nemails, medical license and more.\n\nPresidio detects more out of the box entities than traditional models. This is\npossible because Presidio leverages a couple of methods in detecting PII \u2014\nfrom NER models to regular expressions and rule-based logic.", "mimetype": "text/plain", "start_char_idx": 4409, "end_char_idx": 6714, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "e36ea861-b5c1-4721-b088-169ab15d74aa": {"__data__": {"id_": "e36ea861-b5c1-4721-b088-169ab15d74aa", "embedding": null, "metadata": {"Header_2": " Integrating Presidio with LlamaIndex", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "f3365154-ef8d-4c07-bb32-3a9d7e7d9a20", "node_type": "1", "metadata": {"Header_2": " Introducing: Presidio", "Header_3": " LlamaIndex Post Processors", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "e153638484ed5e71d161f19f0a11d71475e98acf08617a6b059419b166f9e323", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "73b589a3-9845-4a0e-840b-72f4ba5dab3c", "node_type": "1", "metadata": {"Header_2": " Test and Benchmark"}, "hash": "4e8e29b78d5965bb82d290854af1520ebdc71fffd4011ae33c01b5e407be6a71", "class_name": "RelatedNodeInfo"}}, "text": "Integrating Presidio with LlamaIndex\n\nI ended up integrating **_PresidioPIINodePostprocessor_ ** that got the text\nas an input and masked it. Doing this was possible using Presidio\u2019s analyzer\nand anonymizer:\n\n    \n    \n    from presidio_analyzer import AnalyzerEngine\n    from presidio_anonymizer import AnonymizerEngine\n    \n    analyzer = AnalyzerEngine(supported_languages=[\"en\"])\n    results = analyzer.analyze(text=text, language='en')\n    engine = AnonymizerEngine()\n    new_text = engine.anonymize(text=text, analyzer_results=results)\n\nThis was pretty fun and simple. However, given the input text \u201cAlice and Bob\nare friends\u201d, the output would be: \u201c<PERSON> and <PERSON> are friends\u201d. I\ncould not have that.\n\nSo, I added a counter and mapped the original values with the masked values,\nmaking sure that whenever an entity was seen again, the previously asked value\nwas used:\n\n    \n    \n    def anonymize_function(origin, entity_type):\n        nonlocal pii_counter\n        nonlocal inverted_mapping\n        nonlocal mapping\n        if entity_type not in inverted_mapping:\n            inverted_mapping[entity_type] = {}\n        typed_mapping = inverted_mapping[entity_type]\n        if origin in typed_mapping:\n            return typed_mapping[origin]\n        new_value = f\"<{entity_type}_{pii_counter}>\"\n        typed_mapping[origin] = new_value\n        mapping[new_value]=origin\n        pii_counter+=1\n        return typed_mapping[origin]\n    \n    from presidio_analyzer import AnalyzerEngine\n    from presidio_anonymizer import AnonymizerEngine\n    from presidio_anonymizer.entities import OperatorConfig\n    \n    analyzer = AnalyzerEngine(supported_languages=[\"en\"])\n    results = analyzer.analyze(text=text, language='en')\n    engine = AnonymizerEngine()\n    new_text = engine.anonymize(text=text, analyzer_results=results, \n                                operators={\"DEFAULT\": OperatorConfig(\"custom\", \n                                params={\"lambda\": anonymize_function})})\n\n_Note: Currently presidio doesn\u2019t contain the entity type as an input\nparameter in the lambda function, so I had to add this functionality._", "mimetype": "text/plain", "start_char_idx": 6720, "end_char_idx": 8848, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "73b589a3-9845-4a0e-840b-72f4ba5dab3c": {"__data__": {"id_": "73b589a3-9845-4a0e-840b-72f4ba5dab3c", "embedding": null, "metadata": {"Header_2": " Test and Benchmark", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "e36ea861-b5c1-4721-b088-169ab15d74aa", "node_type": "1", "metadata": {"Header_2": " Integrating Presidio with LlamaIndex", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "72cb0b59fa1622b2079e946ea562bb1ca7ba3c1a23848b9686959c044dc52113", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "7cc6865b-6c1f-46e1-b7af-9a5e0de218d3", "node_type": "1", "metadata": {"Header_2": " How It Ended"}, "hash": "67d89e7083096059940450b535894959540c22a64fa870e046dea73aeb8c5980", "class_name": "RelatedNodeInfo"}}, "text": "Test and Benchmark\n\nOnce this was all up and running, I was able to call the newly added presidio\npost processor with the text from the previous run:\n\n    \n    \n    from llama_index.postprocessor import PresidioPIINodePostprocessor\n    from llama_index import ServiceContext\n    from llama_index.schema import TextNode\n    \n    text = \"\"\"\n    My name is Roey Ben Chaim and my credit card number is 4095-2609-9393-4932. \n    My email is robo@presidio.site and I live in Amsterdam.\n    Have you been to a P\u00e1lmi Einarsson concert before?\n    What is the limit for card 4158112277712? My IBAN is GB90YNTU67299444055881. \n    What's your last name? Bob, it's Bob.\n    My great great grandfather was called Yulan Peres, \n    and my great great grandmother was called Jennifer Holst\n    I can't browse to your site, keep getting address 179.177.214.91 blocked error\n    Just posted a photo https://www.FilmFranchise.dk/\n    \"\"\"\n    \n    node = TextNode(text=text)\n    \n    service_context = ServiceContext.from_defaults()\n    processor = PresidioPIINodePostprocessor(service_context=service_context)\n    \n    from llama_index.schema import NodeWithScore\n    \n    new_nodes = processor.postprocess_nodes([NodeWithScore(node=node)])\n    print(new_nodes[0].node.get_text())\n\nRunning the above code resulted in the following:\n\n    \n    \n    My name is <PERSON_12> and my credit card number is <CREDIT_CARD_11>. \n    My email is <EMAIL_ADDRESS_10> and I live in <LOCATION_9>.\n    Have you been to a <PERSON_8> concert before?\n    What is the limit for card <CREDIT_CARD_7>? My IBAN is <IBAN_CODE_6>. \n    What's your last name? <PERSON_5>, it's <PERSON_5>.\n    My great great grandfather was called <PERSON_4>, \n    and my great great grandmother was called <PERSON_3>\n    I can't browse to your site, keep getting address <IP_ADDRESS_2> blocked error\n    Just posted a photo <URL_1>\n\nOverall Presidio detected 12 entities while the other NER solution detected 8.\nNotice that credit card numbers, email address, IBAN, IP address and the URL\n(at least some of it) weren\u2019t detected.\n\nI was curious to see how the parsing of these strings would work on the LLM,\nso I populated the index and queried the following:\n\n    \n    \n    from llama_index import VectorStoreIndex\n    \n    index = VectorStoreIndex([n.node for n in new_nodes])\n    response = index.as_query_engine().query(\n        \"What is my name?\"\n    )\n    print(response)\n\nWhich resulted in:\n\n    \n    \n    Your name is <PERSON_12>.", "mimetype": "text/plain", "start_char_idx": 8854, "end_char_idx": 11331, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "7cc6865b-6c1f-46e1-b7af-9a5e0de218d3": {"__data__": {"id_": "7cc6865b-6c1f-46e1-b7af-9a5e0de218d3", "embedding": null, "metadata": {"Header_2": " How It Ended", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "73b589a3-9845-4a0e-840b-72f4ba5dab3c", "node_type": "1", "metadata": {"Header_2": " Test and Benchmark", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b8faa734720a711bfb2d70261b8b210353c1ac4629a468b6ee6983e7ca39e129", "class_name": "RelatedNodeInfo"}, "3": {"node_id": "abf1e403-8b3c-419c-b9cb-64d07d07197a", "node_type": "1", "metadata": {"Header_2": " How It Ended", "Header_3": " Update"}, "hash": "22bc54d701f06e6753e69c537ae786655769ca873cc01603e64105c05a748133", "class_name": "RelatedNodeInfo"}}, "text": "How It Ended\n\nAnyway, this project won the 3rd place (in the continuous track) in the RAG-A-\nTHON.\n\nNote: this picture doesn\u2019t contain PII", "mimetype": "text/plain", "start_char_idx": 11337, "end_char_idx": 11475, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}, "abf1e403-8b3c-419c-b9cb-64d07d07197a": {"__data__": {"id_": "abf1e403-8b3c-419c-b9cb-64d07d07197a", "embedding": null, "metadata": {"Header_2": " How It Ended", "Header_3": " Update", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "excluded_embed_metadata_keys": [], "excluded_llm_metadata_keys": [], "relationships": {"1": {"node_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde", "node_type": "4", "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "b6e6bc68e1f136b1dde8a1d0fd8ae026b5eb3cbcfa282fd1f2686fdf7340ab82", "class_name": "RelatedNodeInfo"}, "2": {"node_id": "7cc6865b-6c1f-46e1-b7af-9a5e0de218d3", "node_type": "1", "metadata": {"Header_2": " How It Ended", "filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}, "hash": "6b8e0ece5c463c9b4d4b1900b69f6bf17a9188ef174c15c420252bb820a35320", "class_name": "RelatedNodeInfo"}}, "text": "Update\n\nPresidio is now fully integrated into LlamaIndex as a post processor, follow\nthis [ notebook ](https://github.com/run-\nllama/llama_index/blob/ff51e2cbf9815a44ebade9a1382216435d7f4bc8/docs/examples/node_postprocessor/PII.ipynb#L289)\nto learn how to use Presidio for PII masking. The next steps would be to add\nmore customization and anonymization options.", "mimetype": "text/plain", "start_char_idx": 11482, "end_char_idx": 11844, "text_template": "{metadata_str}\n\n{content}", "metadata_template": "{key}: {value}", "metadata_seperator": "\n", "class_name": "TextNode"}, "__type__": "1"}}, "docstore/metadata": {"8754d684-ffb0-4d01-a726-bfeb8d0b7cfd": {"doc_hash": "5e1dceb56189bb2ed4753b846ee85dbd9ed4ce6931477f5c03c8eb13859304ed", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "195745e2-1bea-4ad4-9246-5c941fe72cef": {"doc_hash": "d4b077ca96769bfbca149864554d210b1c54a925efd05c9341cce97090aeff3c", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "118f4977-267c-40b1-9f8e-c2dce115affe": {"doc_hash": "01a27a3706212263c38fec7c0cc91d7c94e310b5154a9f20a5f4b2692dd9850b", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "398eb621-2a13-47d7-89d4-574f129bb4c0": {"doc_hash": "0d19f7b8d8a3e384048e39911a2a650634bfaecb84590b081b7de0ff1c79176d", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "54646341-5737-4ac1-9c69-cf4364ae77cc": {"doc_hash": "a67c6ca8f98f518a7b0161d3633971695656b337890827331a7840fc8ea69023", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "ebd765b0-8125-4916-8a45-474ce23fff5d": {"doc_hash": "8669ceaed21feded1caf6d84825443b0d729c2b6d79add3a76c9f675686368e8", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "e2e98001-7d78-495d-a324-7704fd2a074b": {"doc_hash": "975185a2bdaf40963fc9ce7e5b11464f95d96e79550847de8a42d02bfac47893", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "f3365154-ef8d-4c07-bb32-3a9d7e7d9a20": {"doc_hash": "e153638484ed5e71d161f19f0a11d71475e98acf08617a6b059419b166f9e323", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "e36ea861-b5c1-4721-b088-169ab15d74aa": {"doc_hash": "72cb0b59fa1622b2079e946ea562bb1ca7ba3c1a23848b9686959c044dc52113", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "73b589a3-9845-4a0e-840b-72f4ba5dab3c": {"doc_hash": "b8faa734720a711bfb2d70261b8b210353c1ac4629a468b6ee6983e7ca39e129", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "7cc6865b-6c1f-46e1-b7af-9a5e0de218d3": {"doc_hash": "6b8e0ece5c463c9b4d4b1900b69f6bf17a9188ef174c15c420252bb820a35320", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}, "abf1e403-8b3c-419c-b9cb-64d07d07197a": {"doc_hash": "c10bdae4cc35970357dd70aae39a981dc3d9f35a782fa4c87d5be60bdad539ca", "ref_doc_id": "aa2cf3b2-0054-4c96-a1b0-858feae76fde"}}, "docstore/ref_doc_info": {"aa2cf3b2-0054-4c96-a1b0-858feae76fde": {"node_ids": ["8754d684-ffb0-4d01-a726-bfeb8d0b7cfd", "195745e2-1bea-4ad4-9246-5c941fe72cef", "118f4977-267c-40b1-9f8e-c2dce115affe", "398eb621-2a13-47d7-89d4-574f129bb4c0", "54646341-5737-4ac1-9c69-cf4364ae77cc", "ebd765b0-8125-4916-8a45-474ce23fff5d", "e2e98001-7d78-495d-a324-7704fd2a074b", "f3365154-ef8d-4c07-bb32-3a9d7e7d9a20", "e36ea861-b5c1-4721-b088-169ab15d74aa", "73b589a3-9845-4a0e-840b-72f4ba5dab3c", "7cc6865b-6c1f-46e1-b7af-9a5e0de218d3", "abf1e403-8b3c-419c-b9cb-64d07d07197a"], "metadata": {"filename": "pii-detector-hacking-privacy-in-rag.md", "extension": ".md", "title": "PII Detector: hacking privacy in RAG", "date": "Mar 13, 2024", "url": "https://www.llamaindex.ai/blog/pii-detector-hacking-privacy-in-rag"}}}}